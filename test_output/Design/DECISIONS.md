# Reso2 设计决策记录

> 由 Mosaic 生成 - 2026-01-18
> 记录所有关键设计决策及其原因

---

## 项目背景

### 项目分析

```yaml
项目名称: Reso2
项目类型: macOS/iOS CLI 工具
核心功能:
  - Whisper V3 Turbo 语音识别
  - QWEN2.5 文本润色
  - 自动化转录流程

目标用户:
  - 专业人士（开发者、研究人员）
  - 内容创作者
  - 会议记录员
  - 学生/教育工作者

使用场景:
  - 会议录音转录
  - 讲座内容记录
  - 播客/视频字幕生成
  - 采访整理

当前状态:
  - 纯 CLI 界面
  - 功能完善但缺少图形界面
  - 需要专业的 macOS GUI
```

---

## 核心设计决策

### 1. 设计方向：专业深色主题

**决策**：选择深色主题作为主要设计方向

**原因**：
- **长时间使用场景** - 用户需要长时间查看转录结果，深色主题减少视觉疲劳
- **专业工具定位** - 目标用户是专业人士，深色主题传达专业、高效的感觉
- **内容聚焦** - 深色背景让转录文本更突出
- **符合行业惯例** - AI/开发工具普遍使用深色主题（VS Code, Linear, Raycast等）

**参考**：
- Whisper App (深色主题)
- Transcriptify (专业转录工具)
- macOS Terminal/Xcode (系统工具)

**色彩选择**：
- 主色：紫蓝色 (#5E6AD2) - 科技感、AI工具常用色
- 背景：深灰黑 (#0A0A0B) - 极低视觉疲劳
- 文字：白色/灰色渐变 - 清晰的信息层级

---

### 2. 信息架构：三栏布局

**决策**：采用侧边栏 + 主内容 + 详情面板的三栏布局

**布局结构**：
```
┌────────┬─────────────────────┬──────────────┐
│ 侧边栏  │    主内容区          │   详情面板    │
│        │                     │              │
│ 转录    │  [文件拖拽区]        │  [设置选项]   │
│ 历史    │                     │              │
│ 设置    │  [转录结果展示]      │  [进度信息]   │
│        │                     │              │
└────────┴─────────────────────┴──────────────┘
```

**原因**：
- **侧边栏** - 主要导航清晰可见，快速切换功能
- **主内容区** - 宽阔的空间展示转录结果和润色对比
- **详情面板** - 不干扰主要内容，显示设置和进度

**优点**：
- 符合 macOS 应用惯例
- 可根据需要显示/隐藏详情面板
- 适合处理长文本内容

---

### 3. 文字显示：等宽字体

**决策**：转录结果使用 SF Mono（等宽字体）

**原因**：
- **对齐整齐** - 等宽字体让文本对齐更整齐
- **易于比较** - 原始转录 vs 润色后文本的对比更清晰
- **专业感** - 等宽字体传达技术专业感
- **可读性** - 在长文本中更易定位

**其他文字**：
- 界面文字使用 SF Pro（系统默认）
- 代码/路径使用 SF Mono

---

### 4. 交互模式：拖拽优先

**决策**：支持文件拖拽作为主要输入方式

**原因**：
- **高效** - 拖拽比点击选择文件更快
- **符合 macOS 惯例** - macOS 用户习惯拖拽操作
- **批量处理** - 可一次拖入多个文件

**备选方案**：
- 也支持点击选择文件
- 支持快捷键 (Cmd+O)
- 支持 Services 菜单

---

### 5. 进度反馈：分阶段显示

**决策**：明确区分转录和润色两个阶段，独立显示进度

**阶段设计**：
```
1. 准备阶段
   └─> 加载模型、检查文件

2. 转录阶段
   └─> Whisper V3 实时进度
   └─> 显示已转录的文本（流式）

3. 润色阶段
   └─> QWEN2.5 处理进度
   └─> 显示润色风格

4. 完成阶段
   └─> 显示对比结果
   └─> 导出选项
```

**原因**：
- **透明性** - 用户清楚知道当前处理到哪一步
- **耐心等待** - 明确的进度减少用户焦虑
- **可中断** - 用户可以在任意阶段停止

---

### 6. 结果展示：左右对比

**决策**：转录结果采用左右对比布局

```
┌──────────────────┬──────────────────┐
│  原始转录         │  润色后文本       │
│                  │                  │
│  这是原始的...    │  这是润色后的...  │
│                  │                  │
│  [复制] [导出]    │  [复制] [导出]   │
└──────────────────┴──────────────────┘
```

**原因**：
- **直观对比** - 用户能立即看到润色效果
- **独立操作** - 可以分别复制或导出任一版本
- **教育价值** - 展示 AI 润色的改进

**替代方案（未采用）**：
- ❌ 标签页切换 - 需要来回切换，不直观
- ❌ 上下对比 - 浪费横向空间

---

### 7. 设置管理：内联 vs 独立面板

**决策**：常用设置（润色风格、温度）内联显示，高级设置放在设置面板

**内联设置**：
- 润色风格选择
- 温度参数
- 输出格式

**设置面板**：
- 模型选择（Whisper/QWEN版本）
- 计算单元配置
- 快捷键设置
- 存储路径

**原因**：
- **效率** - 常用设置随手可调
- **简洁** - 主界面不被大量设置占据
- **分层** - 新手/高级用户的需求分离

---

### 8. 历史记录：卡片式列表

**决策**：历史记录使用卡片列表，显示关键信息

**卡片内容**：
```
┌─────────────────────────────────────┐
│ 📄 meeting.m4a                      │
│                                     │
│ 2026-01-18  15:23  |  专业风格      │
│ 时长: 15:23  |  大小: 45.2 MB      │
│                                     │
│ "今天的会议主要讨论了..."  (预览)   │
│                                     │
│ [查看全文] [重新处理] [导出]         │
└─────────────────────────────────────┘
```

**原因**：
- **快速浏览** - 一眼看到所有历史记录
- **搜索友好** - 可按文件名、日期、关键词搜索
- **便捷操作** - 直接从卡片重新处理或导出

---

### 9. 快捷键设计

**决策**：支持全局快捷键和上下文快捷键

**全局快捷键**：
- `Cmd+N` - 新建转录任务
- `Cmd+O` - 打开文件
- `Cmd+,` - 打开设置
- `Cmd+1/2/3` - 切换视图

**上下文快捷键**：
- `Cmd+C` - 复制当前文本
- `Cmd+S` - 保存/导出
- `Space` - 播放/暂停音频（如果有）

**原因**：
- **效率** - 键盘操作比鼠标快
- **专业用户** - 目标用户习惯快捷键
- **可发现性** - 菜单中显示快捷键

---

### 10. 错误处理：友好提示

**决策**：错误分级，提供清晰的解决方案

**错误级别**：
1. **轻微错误** - Toast 提示（3秒自动消失）
2. **中等错误** - Banner 提示（需手动关闭）
3. **严重错误** - 模态对话框（必须处理）

**错误信息设计**：
```
❌ 错误标题（简洁）

详细说明（用户可理解的语言）

💡 建议的解决方案：
1. 检查文件格式是否支持
2. 确保文件没有损坏
3. 尝试转换为 .wav 格式

[重试] [取消]
```

**原因**：
- **不慌张** - 清晰的错误信息减少用户焦虑
- **可操作** - 提供具体的解决步骤
- **学习** - 帮助用户理解问题

---

## 技术选型

### SwiftUI vs AppKit

**决策**：使用 SwiftUI

**原因**：
- **现代化** - SwiftUI 是未来方向
- **声明式** - 代码更简洁易维护
- **响应式** - 自动处理状态更新
- **跨平台** - macOS/iOS 共享代码

**权衡**：
- ❌ 某些高级功能可能需要 AppKit 桥接
- ✅ 项目已使用 SwiftUI (WhisperKit, ArgumentParser)

---

### 状态管理：@StateObject vs ObservableObject

**决策**：使用 @StateObject 配合 @EnvironmentObject

**架构**：
```swift
@main
struct Reso2App: App {
    @StateObject private var appState = AppState()

    var body: some Scene {
        WindowGroup {
            MainWindow()
                .environmentObject(appState)
        }
    }
}
```

**原因**：
- **单一数据源** - AppState 作为唯一真实来源
- **自动更新** - 状态变化自动刷新 UI
- **易测试** - 状态独立于 UI

---

## 未采纳的方案

### 1. 浅色主题作为默认 ❌

**为什么不选**：
- 长时间使用会造成视觉疲劳
- 不符合专业工具惯例
- 转录文本在浅色背景上不够突出

**妥协**：
- 提供浅色主题作为选项（低优先级）

---

### 2. 单窗口模式（只有主界面）❌

**为什么不选**：
- 功能较多，单窗口会很拥挤
- 缺少清晰的信息架构
- 不利于批量处理

**妥协**：
- 支持全屏模式（隐藏侧边栏）

---

### 3. 所有组件用第三方库 ❌

**为什么不选**：
- 增加依赖复杂度
- 系统原生组件更可靠
- 更好的性能和一致性

**妥协**：
- 仅在必要时使用第三方（如特殊动画）

---

## 设计系统扩展

### 未来可能的增强

1. **主题定制**
   - 允许用户自定义颜色
   - 保存多套主题预设

2. **布局定制**
   - 可调整侧边栏宽度
   - 可隐藏/显示详情面板

3. **动画增强**
   - 转录时的文字流动效果
   - 润色时的高亮变化动画

4. **可访问性**
   - 完整的 VoiceOver 支持
   - 键盘导航
   - 高对比度模式

---

## 验收清单

### 设计质量

- [x] 符合 Apple Human Interface Guidelines
- [x] 支持深色模式
- [x] 响应式布局（支持不同窗口尺寸）
- [x] 清晰的信息层级
- [x] 一致的设计语言

### 技术质量

- [x] 所有颜色/字体/间距使用设计系统变量
- [x] 组件可复用
- [x] 状态管理清晰
- [x] 性能优化（避免不必要的重绘）
- [x] 代码注释完整

### 用户体验

- [x] 直观的操作流程
- [x] 清晰的进度反馈
- [x] 友好的错误提示
- [x] 支持快捷键
- [x] 支持拖拽操作

---

**最后更新**: 2026-01-18
**设计师**: Mosaic CDO Agent
**状态**: 已完成并交付
